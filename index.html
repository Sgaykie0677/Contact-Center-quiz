<script>
  const DEFINITIONS = {
    "R15": "Reject code for missing prior authorization.",
    "R05": "Reject code for duplicate submission.",
    "Eligibility": "Verification that the caller is an active member with valid coverage.",
    "MHK": "System used to track Clinical Review workflows and documentation.",
    "Escalation": "Routing a call or case to a higher authority (supervisor, pharmacist) per protocol.",
    "Compliance": "Following rules, policies, and regulations to protect members and the organization.",
    "Documentation": "Recording actions, outcomes, and rationale in a structured, audit-ready format.",
    "Scripts": "Standardized phrasing used to guide calls and ensure consistency.",
    "Non-member": "Caller who is not the member; requires limited disclosure and documentation."
  };

  const QUESTIONS = [
    {
      section:"member",
      q:"What is the first step when handling a Clinical Review call?",
      options:["Verify member identity","Check escalation protocol","Document reject code","Transfer to supervisor"],
      a:0,
      expl:"Always verify member identity first to ensure compliance.",
      term:"Eligibility",
      playbookLang:"Per playbook: 'Begin every call by verifying the member’s identity using two approved identifiers.'"
    },
    {
      section:"clinical",
      q:"Which system is used to track Clinical Review workflows?",
      options:["Email","MHK","Spreadsheets","Chat logs"],
      a:1,
      expl:"MHK is the official tool to track review status.",
      term:"MHK",
      playbookLang:"Per playbook: 'All Clinical Review workflows must be documented and tracked in the MHK system.'"
    },
    {
      section:"rejects",
      q:"Which reject code applies when prior authorization is missing?",
      options:["R01","R15","R22","R99"],
      a:1,
      expl:"R15 is used when prior authorization is missing.",
      term:"R15",
      playbookLang:"Per playbook: 'Use reject code R15 when prior authorization is not on file.'"
    }
    // ... add more questions with playbookLang
  ];

  function submitAnswer() {
    let score = 0;
    QUESTIONS.forEach((q,i) => {
      const selected = document.querySelector(`input[name="q${i}"]:checked`);
      const fb = document.getElementById(`fb${i}`);
      if (!fb) return;
      fb.style.display = "block";
      const defText = q.term && DEFINITIONS[q.term] ? `Definition: ${DEFINITIONS[q.term]}` : "";
      const langText = q.playbookLang ? `Playbook Language: ${q.playbookLang}` : "";
      if (selected && parseInt(selected.value) === q.a) {
        score++;
        fb.className = "feedback correct";
        fb.innerHTML = `✅ Correct — ${q.expl}<br>${defText}<br>${langText}`;
      } else if (selected) {
        fb.className = "feedback incorrect";
        fb.innerHTML = `❌ Incorrect — ${q.expl}<br>${defText}<br>${langText}`;
      } else {
        fb.className = "feedback incorrect";
        fb.innerHTML = `⚠️ No answer selected — ${q.expl}<br>${defText}<br>${langText}`;
      }
    });
    document.getElementById("result").innerText = `You scored ${score} out of ${QUESTIONS.length}`;
  }
</script>
